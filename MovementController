using UnityEngine;
using System.Collections;

public class MovementController : MonoBehaviour 
{
	public float moveSpeed = 6;

	public CharacterController cc;
	public Camera myCamera;

	//public Weapon weapon;

	// Use this for initialization
	void Start () 
	{

	}

	// Update is called once per frame
	void Update () 
	{
		MoveInputProcessing();
		PlayerRotation();

		//Debug.DrawLine(  transform.position, transform.TransformPoint(Vector3.forward*10)  );

	}

	public void MoveInputProcessing()
	{
		Vector3 moveInput = new Vector3 ( Input.GetAxisRaw ("Horizontal"), 0, Input.GetAxisRaw ("Vertical") );
		Vector3 direction = moveInput.normalized * moveSpeed;
		cc.Move( direction * Time.deltaTime );

	}

	public void PlayerRotation()
	{
		Ray ray = myCamera.ScreenPointToRay( Input.mousePosition );
		Plane groundPlane = new Plane ( Vector3.up, transform.position );
		float rayDistance;

		if( groundPlane.Raycast(ray, out rayDistance) )
		{
			Vector3 lookPoint = ray.GetPoint (rayDistance);

			transform.LookAt (lookPoint);
		}
	}

	public void SetCamera(Camera myCam)
	{
		myCamera = myCam;
	}	
}
