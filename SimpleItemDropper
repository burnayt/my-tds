using UnityEngine;
using System.Collections;

public class SimpleItemDropper : MonoBehaviour 
{
	public GameObject[] items;

	public int[] coefficients;

	void Start()
	{

	}

	public void Drop ( Vector3 position )
	{
		//Debug.Log("***");
		int result = SumOfCoefficients();

		int chance = Random.Range(0, result);

		int lowerChance = 0;
		int upperChance = 0;

		//Debug.Log( "Start cycle. Result = " + result + ". Chance = " + chance);

		for (int i = 0; i < coefficients.Length; i++) 
		{
			//Debug.Log( "Iteration number " + i );

			if(i == 0)
			{
				lowerChance = 0;
			}
			else
			{
				lowerChance = coefficients[ i - 1 ]; 
			}


			upperChance += coefficients[i];

			//Debug.Log("LowerChance is " + lowerChance + ". UpperChance is " + upperChance );

			if( chance >= lowerChance && chance < upperChance ) // chance < upperChance, а не "=>" иначе повышаеться шанс каждого кроме последнего
			{
				//Debug.Log ("Hit! Winner is " +  items[i].name);

				if(items[i].name != "NullItem")
				{
					Instantiate(items[i], position, transform.rotation);
				}

				return;

			}
		}

	}

	private int SumOfCoefficients()
	{
		int result = 0;

		foreach( int chance in coefficients )
		{
			result += chance;
		}
		return result;
	}


}
